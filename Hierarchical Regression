#pull the data into R
library(readxl)
library(psych)
library(plyr)
library(Hmisc)
library(ggplot2)
get0option(max.print)
sleepdata <- read_excel("C:/Users/veray/Desktop/sleepdata.xlsx")
View(sleepdata)

#can I just use this command once? 
attach(sleepdata)

#compute the means for each variable, create new variables
#diary variables
sleepdata$dTSTmean <- (dTST10 + dTST14 + dTST18)/3
sleepdata$dSLmean <- (dSL10 + dSL14 + dSL18)/3
sleepdata$dSEmean <- (dSE1_10 + dSE1_14 + dSE1_18 + dSE2_10 + dSE2_14 + dSE2_18)/6
sleepdata$dWASOmean <- (dWASO10 + dWASO14 + dWASO18)/3
sleepdata$dAROUSEmean <- (dAROUSE10 + dAROUSE14 + dAROUSE18)/3
detach(sleepdata)

#actigraphy variables
attach(sleepdata)
sleepdata$aSEmean <- (aSE10 + aSE14 + aSE18)/3
sleepdata$aSLmean <- (aSL10 + aSL14 + aSL18)/3
sleepdata$aWASOmean <- (aWASO10 + aWASO14 + aWASO18)/3
detach(sleepdata)

#sleep quality variables
attach(sleepdata)
sleepdata$PSQImean <- (PSQI10 + PSQI14 + PSQI18)/3
sleepdata$dVASmean <- (dVAS10 + dVAS14 + dVAS18)/3
sleepdata$aFRAGmean <- (aFRAG10 + aFRAG14 + aFRAG18)/3
detach(sleepdata)

#Inflammatory marker variables
attach(sleepdata)
sleepdata$IL_6mean <- (IL6_10 + IL6_14 + IL6_18)/3
sleepdata$INFGmean <- (INFG10 + INFG14 + INFG18)/3
sleepdata$TNFamean <- (TNFa_10 + TNFa_14 + TNFa_18)/3
detach(sleepdata)

#demographic variables or covariates
attach(sleepdata)
sleepdata$PSSmean <- (PSS10 + PSS14 + PSS18)/3
sleepdata$APGARmean <- (APGAR1 + APGAR5)/2
detach(sleepdata)

#change relationship type to attached yes/no
attach(sleepdata)
sleepdata$rscat <- NA
sleepdata$rscat[S1_Married > 3] <- "0"
sleepdata$rscat[S1_Married <= 2] <- "1"
sleepdata$PSQIGroup <- NA
sleepdata$PSQIGroup[PSQImean > 5] <- "1"
sleepdata$PSQIGroup[PSQImean <= 5] <- "0"
detach(sleepdata)

# Descriptive statistics for every variable.  Item name, number, how many valid records, mean, sd, median, mad, min, max, skew, kurtosis, se
library(psych)
attach(sleepdata)
describe(sleepdata)
detach(sleepdata)

#Log Transform Skewed/Kurt Variables
attach(sleepdata)
sleepdata$IL6 <- log10(IL_6mean)
sleepdata$INFG <- log10(INFGmean)
sleepdata$APGAR <- log10(APGARmean)
sleepdata$dSL <- log10(dSLmean)
detach(sleepdata)

#New Descriptives
library(psych)
attach(sleepdata)
describe(sleepdata)
detach(sleepdata)

#run t.tests on outcome variables based on PSQI cut off
#cytokine markers
t.test(IL6~PSQIGroup)
t.test(INFG~PSQIGroup)
t.test(TNFamean~PSQIGroup)

#pregnancy outcomes
t.test(APGAR~PSQIGroup)
t.test(O_GestationalAge~PSQIGroup) 
t.test(O_Infant_Weight~PSQIGroup)#sig
t.test(O_Complication01~PSQIGroup)

t.test(IL6~O_Complication01)
t.test(INFG~O_Complication01)
t.test(TNFamean~O_Complication01)

t.test(dWASOmean~O_Complication01)
t.test(dTSTmean~O_Complication01)
t.test(dSEmean~O_Complication01)
t.test(dSLmean~O_Complication01)
t.test(dAROUSEmean~O_Complication01)

t.test(aWASOmean~O_Complication01)
t.test(aSEmean~O_Complication01)
t.test(aSLmean~O_Complication01)
t.test(aFRAGmean~O_Complication01)

#test for correlations
cor.test(dWASOmean, IL6)
cor.test(dWASOmean, TNFamean)
cor.test(dWASOmean, INFG)
cor.test(dWASOmean, O_Complication01)
cor.test(dWASOmean, O_GestationalAge)
cor.test(dWASOmean, O_Infant_Weight)

cor.test(dWASOmean, IL6)
cor.test(dWASOmean, TNFamean)
cor.test(dWASOmean, INFG)
cor.test(dWASOmean, O_Complication01)
cor.test(dWASOmean, O_GestationalAge)
cor.test(dWASOmean, O_Infant_Weight)

cor.test(dTSTmean, IL6)
cor.test(dTSTmean, TNFamean) 
cor.test(dTSTmean, INFG)
cor.test(dTSTmean, O_Complication01)
cor.test(dTSTmean, O_GestationalAge)
cor.test(dTSTmean, O_Infant_Weight)

cor.test(dSLmean, IL6) #sig
cor.test(dSLmean, TNFamean) 
cor.test(dSLmean, INFG)
cor.test(dSLmean, O_Complication01)
cor.test(dSLmean, O_GestationalAge) #sig
cor.test(dSLmean, O_Infant_Weight)

cor.test(dSEmean, IL6) #sig
cor.test(dSEmean, TNFamean) 
cor.test(dSEmean, INFG)
cor.test(dSEmean, O_Complication01)
cor.test(dSEmean, O_GestationalAge)
cor.test(dSEmean, O_Infant_Weight)

cor.test(aWASOmean, IL6)
cor.test(aWASOmean, TNFamean) #sig
cor.test(aWASOmean, INFG)
cor.test(aWASOmean, O_Complication01)
cor.test(aWASOmean, O_GestationalAge)
cor.test(aWASOmean, O_Infant_Weight)

cor.test(aSEmean, IL6)
cor.test(aSEmean, TNFamean) 
cor.test(aSEmean, INFG)
cor.test(aSEmean, O_Complication01) #sig
cor.test(aSEmean, O_GestationalAge)
cor.test(aSEmean, O_Infant_Weight)

cor.test(aSLmean, IL6)
cor.test(aSLmean, TNFamean) 
cor.test(aSLmean, INFG)
cor.test(aSLmean, O_Complication01)
cor.test(aSLmean, O_GestationalAge) #sig
cor.test(aSLmean, O_Infant_Weight) #sig

cor.test(PSQImean, IL6) #sig
cor.test(PSQImean, TNFamean) 
cor.test(PSQImean, INFG)
cor.test(PSQImean, O_Complication01)
cor.test(PSQImean, O_GestationalAge) 
cor.test(PSQImean, O_Infant_Weight) 

cor.test(PSQIMean, IL6) #sig
cor.test(PSQIMean, TNFamean) 
cor.test(PSQIMean, INFG)
cor.test(PSQIMean, O_Complication01)
cor.test(PSQIMean, O_GestationalAge) #sig
cor.test(PSQIMean, O_Infant_Weight) #sig

GAfit1<- lm(O_GestationalAge ~ S1_Age + S1_BMI + S1_Parity1, data=sleepdata)

GAfit2 <- lm(O_GestationalAge ~ S1_Age + S1_BMI + S1_Parity1 + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)

GAfit3 <- lm(O_GestationalAge ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)

GAfit4 <- lm(O_GestationalAge ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)

GAfit5 <- lm(O_GestationalAge ~ S1_Age + S1_BMI + S1_Parity1 + aWASOmean + aSLmean + aSEmean + aFRAGmean + dAROUSEmean + dSLmean + dSEmean + dTSTmean+ dWASOmean + IL6 + INFG + TNFamean, data=sleepdata)

summary(GAfit1)
summary(GAfit2
summary(GAfit3)
summary(GAfit4)

vif(GAfit4) # variance inflation factors 
sqrt(vif(GAfit4)) > 2 # problem?

IWfit1 <- lm(O_Infant_Weight ~ S1_Age + S1_BMI + S1_Parity1, data=sleepdata)
summary(IWfit1)

IWfit2 <- lm(O_Infant_Weight ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean, data=sleepdata)
summary(IWfit2)

IWfit3 <- lm(O_Infant_Weight ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(IWfit3)

IWfit4 <- lm(O_Infant_Weight ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean + IL6 + INFG + TNFamean, data=sleepdata)
summary(IWfit4)

APGARfit1 <- lm(APGARmean ~ S1_Age + S1_BMI + S1_Parity1, data=sleepdata)
summary(APGARfit1)

APGARfit2 <- lm(APGARmean ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean, data=sleepdata)
summary(APGARfit2)

APGARfit3 <- lm(APGARmean ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(APGARfit3)

APGARfit4 <- lm(APGARmean ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean + IL6 + INFG + TNFamean, data=sleepdata)
summary(APGARfit4)

Compfit1 <- glm(O_Complication01 ~ S1_Age + S1_BMI + S1_Parity1, data=sleepdata)
summary(Compfit1)

Compfit2 <- glm(O_Complication01 ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean, data=sleepdata)
summary(Compfit2)

Compfit3 <- glm(O_Complication01 ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(Compfit3)

Compfit4 <- glm(O_Complication01 ~ S1_Age + S1_BMI + S1_Parity1 + dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean + IL6 + INFG + TNFamean, data=sleepdata)
summary(Compfit4)


APGARfit6 <- lm(APGARmean ~ IL6 + INFG + TNFamean, data=sleepdata)
summary(APGARfit6)
GAfit6 <- lm(O_Gestationalage ~ IL6 + INFG + TNFamean, data=sleepdata)
summary(GAfit6)
IWfit6 <- lm(O_Infant_Weight ~ IL6 + INFG + TNFamean, data=sleepdata)
summary(IWfit6)
Compfit6 <- glm(O_Complication01 ~ IL6 + INFG + TNFamean, data=sleepdata)
summary(Compfit6)



APGARfit3 <- lm(APGARmean ~ dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(APGARfit3)


IWfit3 <- lm(O_Infant_Weight ~ dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(IWfit3)

GAfit3 <- lm(O_GestationalAge ~ dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(GAfit3)

Compfit3 <- glm(O_Complication01 ~ dAROUSEmean + dSLmean + dSEmean + dWASOmean + dTSTmean + aWASOmean + aSLmean + aSEmean + aFRAGmean, data=sleepdata)
summary(Compfit3)
